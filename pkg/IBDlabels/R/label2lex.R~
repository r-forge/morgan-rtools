label2lex <-
function(label, ngam, ifInvalid = "warn"){

    ## label can be a vector
    
    all.lex <- allLex( ngam ) 
    lex <- all.lex[ label+1 ] ## need to +1 as label starts at zero 

    if( any(is.na(lex))) ){ ## INVALID STATE BEHAVIOUR ###
        
        if( ifInvalid == "warn" ){warning( "Label gives invalid state vector \n" )
        }else if( ifInvalid =="NA"){ lex = NA
        }else if( ifInvalid == "err" ){ stop( "Label gives an invalid state vector \n" )}
        
    }

    
    return( lex )  
}
